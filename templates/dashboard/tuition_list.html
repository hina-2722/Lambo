{% extends 'dashboard_base.html' %}

{% block content %}
  <h1>月謝管理</h1>

  <form method="GET" action="" style="margin-top:20px; margin-bottom:20px;">
    <input type="text" name="search" placeholder="生徒名を入力" value="{{ search_query }}">
    <button type="submit">検索</button>
</form>

  <table>
    <thead>
      <tr>
        <th>生徒名</th>
        <th>学校</th>
        <th>回数</th>
        <th>支払金額</th>
        <th>支払期限</th>
        <th>チケット</th>
        <th>保護者名</th>
        <th>支払状況</th>
      </tr>
    </thead>
    <tbody>
      {% for tuition in tuitions %}
        <tr>
          <td>{{ tuition.student.student_name }}</td>
          <td>{{ tuition.age_group }}</td>
          <td>{{ tuition.class_count }}</td>
          <td>{{ tuition.amount }}</td>
          <td>{{ tuition.due_date|date:'m/d' }}</td>
          <td>{{tuition.ticket_num}}</td>
          {% if tuition.payment_status == "未払い"%}
          <td><a href ="mailto:{{ tuition.student.parent.email }}" >{{ tuition.student.parent.username }}</a></td>
          {% else %}
          <td>{{ tuition.student.parent.username }}</td>
          {% endif %}
          <td>{{ tuition.payment_status }}</td>
        </tr>
      {% empty %}
        <tr>
          <td colspan="7">月謝情報がありません。</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock %}

